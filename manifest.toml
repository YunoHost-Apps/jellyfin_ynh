#:schema https://raw.githubusercontent.com/YunoHost/apps/master/schemas/manifest.v2.schema.json

packaging_format = 2

id = "jellyfin"
name = "Jellyfin"
description.en = "Media System that manage and stream your media"
description.fr = "Système multimédia qui gère et diffuse vos médias"

version = "10.10.6~ynh1"

maintainers = ["tituspijean"]

[upstream]
license = "GPL-2.0-only"
website = "https://jellyfin.org"
demo = "https://demo.jellyfin.org/stable/web/index.html"
userdoc = "https://jellyfin.org/docs/"
code = "https://github.com/jellyfin/jellyfin"
cpe = "cpe:2.3:a:jellyfin:jellyfin"
fund = "https://opencollective.com/jellyfin"

[integration]
yunohost = ">= 11.2.18"
helpers_version = "2.1"
architectures = ["armhf", "arm64", "amd64"]
multi_instance = false

ldap = true

sso = true

disk = "300M"
ram.build = "200M"
ram.runtime = "100M"

[install]
    [install.domain]
    type = "domain"

    [install.path]
    type = "path"
    default = "/jellyfin"

    [install.init_main_permission]
    help.en = "Jellyfin has its own login system, you should make it public to let external clients access it (mobile app, etc.)."
    help.fr = "Jellyfin a son propre système de connexion, vous devriez la laisser publique pour permettre la connexion de clients externes (app mobile, etc.)."
    type = "group"
    default = "visitors"

    [install.init_admin_permission]
    ask.en = "Select an account to grant it access to Jellyfin's administration panel."
    ask.fr = "Choisissez un compte pour lui accorder l'accès au tableau de bord d'administration de Jellyfin."
    help.en = "You can grant this access to other accounts and groups with the permission system later."
    help.fr = "Vous pourrez octroire l'accès à d'autres comptes et groupes avec le système de permissions plus tard."
    type = "user"

[resources]

    [resources.sources.server_bullseye]
    armhf.url = "https://repo.jellyfin.org/files/server/debian/stable/v10.10.6/armhf/jellyfin-server_10.10.6+deb11_armhf.deb"
    armhf.sha256 = "27c16dc33ee5c8d30fb74882f734c045454753c299efc98c12a5fa0291585069"
    arm64.url = "https://repo.jellyfin.org/files/server/debian/stable/v10.10.6/arm64/jellyfin-server_10.10.6+deb11_arm64.deb"
    arm64.sha256 = "5face367149c4dad530803160d3c563b9faab20fcc7f73dd9fdee66de5749611"
    amd64.url = "https://repo.jellyfin.org/files/server/debian/stable/v10.10.6/amd64/jellyfin-server_10.10.6+deb11_amd64.deb"
    amd64.sha256 = "932d507b61ce0ab2005e55013f22cf9b86d053bb3cb4d548af35ac837c2cdc17"

    format = "whatever"
    extract = false
    rename = "jellyfin-server.deb"
    prefetch = false

    [resources.sources.server_archive_bullseye]
    armhf.url = "https://repo.jellyfin.org/archive/server/debian/stable/v10.10.6/armhf/jellyfin-server_10.10.6+deb11_armhf.deb"
    armhf.sha256 = "27c16dc33ee5c8d30fb74882f734c045454753c299efc98c12a5fa0291585069"
    arm64.url = "https://repo.jellyfin.org/archive/server/debian/stable/v10.10.6/arm64/jellyfin-server_10.10.6+deb11_arm64.deb"
    arm64.sha256 = "5face367149c4dad530803160d3c563b9faab20fcc7f73dd9fdee66de5749611"
    amd64.url = "https://repo.jellyfin.org/archive/server/debian/stable/v10.10.6/amd64/jellyfin-server_10.10.6+deb11_amd64.deb"
    amd64.sha256 = "932d507b61ce0ab2005e55013f22cf9b86d053bb3cb4d548af35ac837c2cdc17"

    format = "whatever"
    extract = false
    rename = "jellyfin-server.deb"
    prefetch = false

    [resources.sources.server_bookworm]
    armhf.url = "https://repo.jellyfin.org/files/server/debian/stable/v10.10.6/armhf/jellyfin-server_10.10.6+deb12_armhf.deb"
    armhf.sha256 = "12b74ef8a41335f06d9cdf5c2bfdf5f70a74d9485c4d0d275b507f4e5d601fe7"
    arm64.url = "https://repo.jellyfin.org/files/server/debian/stable/v10.10.6/arm64/jellyfin-server_10.10.6+deb12_arm64.deb"
    arm64.sha256 = "534e5ab5b9158bef2ddccdd7e5ccad42a0f21a766c44f3062131a8c93a2a680f"
    amd64.url = "https://repo.jellyfin.org/files/server/debian/stable/v10.10.6/amd64/jellyfin-server_10.10.6+deb12_amd64.deb"
    amd64.sha256 = "b6e48b793b320e3059fd0a33c3e01237466b3d7b84fcb9a6176006b85d384ec9"

    format = "whatever"
    extract = false
    rename = "jellyfin-server.deb"
    prefetch = false

    [resources.sources.server_archive_bookworm]
    armhf.url = "https://repo.jellyfin.org/archive/server/debian/stable/v10.10.6/armhf/jellyfin-server_10.10.6+deb12_armhf.deb"
    armhf.sha256 = "12b74ef8a41335f06d9cdf5c2bfdf5f70a74d9485c4d0d275b507f4e5d601fe7"
    arm64.url = "https://repo.jellyfin.org/archive/server/debian/stable/v10.10.6/arm64/jellyfin-server_10.10.6+deb12_arm64.deb"
    arm64.sha256 = "534e5ab5b9158bef2ddccdd7e5ccad42a0f21a766c44f3062131a8c93a2a680f"
    amd64.url = "https://repo.jellyfin.org/archive/server/debian/stable/v10.10.6/amd64/jellyfin-server_10.10.6+deb12_amd64.deb"
    amd64.sha256 = "b6e48b793b320e3059fd0a33c3e01237466b3d7b84fcb9a6176006b85d384ec9"

    format = "whatever"
    extract = false
    rename = "jellyfin-server.deb"
    prefetch = false

    [resources.sources.web_bullseye]
    url = "https://repo.jellyfin.org/files/server/debian/stable/v10.10.6/amd64/jellyfin-web_10.10.6+deb11_all.deb"
    sha256 = "a3170354c88a3ae70c5cbb7ea573842d23bedf5c9cc1761b1f29838ed2053662"

    format = "whatever"
    extract = false
    rename = "jellyfin-web.deb"
    prefetch = false

    [resources.sources.web_archive_bullseye]
    url = "https://repo.jellyfin.org/archive/server/debian/stable/v10.10.6/amd64/jellyfin-web_10.10.6+deb11_all.deb"
    sha256 = "a3170354c88a3ae70c5cbb7ea573842d23bedf5c9cc1761b1f29838ed2053662"

    format = "whatever"
    extract = false
    rename = "jellyfin-web.deb"
    prefetch = false

    [resources.sources.web_bookworm]
    url = "https://repo.jellyfin.org/files/server/debian/stable/v10.10.6/amd64/jellyfin-web_10.10.6+deb12_all.deb"
    sha256 = "d4b046ed2ab2f91277800cd4c737b301c4ea5835df486c569f9c89478f0ca255"

    format = "whatever"
    extract = false
    rename = "jellyfin-web.deb"
    prefetch = false

    [resources.sources.web_archive_bookworm]
    url = "https://repo.jellyfin.org/archive/server/debian/stable/v10.10.6/amd64/jellyfin-web_10.10.6+deb12_all.deb"
    sha256 = "d4b046ed2ab2f91277800cd4c737b301c4ea5835df486c569f9c89478f0ca255"

    format = "whatever"
    extract = false
    rename = "jellyfin-web.deb"
    prefetch = false

    [resources.sources.ffmpeg_bullseye]
    armhf.url = "https://repo.jellyfin.org/files/ffmpeg/debian/7.x/7.0.2-9/armhf/jellyfin-ffmpeg7_7.0.2-9-bullseye_armhf.deb"
    armhf.sha256 = "5374e0490f9ea482f660160c6c4fcd458131e3d8e2211e7d1f74f541fd767ca3"
    arm64.url = "https://repo.jellyfin.org/files/ffmpeg/debian/7.x/7.0.2-9/arm64/jellyfin-ffmpeg7_7.0.2-9-bullseye_arm64.deb"
    arm64.sha256 = "01450c5227700b72f047c313a33818fa7e898130fea2adf184e4473245e0d4f6"
    amd64.url = "https://repo.jellyfin.org/files/ffmpeg/debian/7.x/7.0.2-9/amd64/jellyfin-ffmpeg7_7.0.2-9-bullseye_amd64.deb"
    amd64.sha256 = "3470f118c98cbc2e2d5c4ffc5000dbdf31a832276da878bc3487d8248b1475bf"

    format = "whatever"
    extract = false
    rename = "jellyfin-ffmpeg7.deb"

    [resources.sources.ffmpeg_bookworm]
    armhf.url = "https://repo.jellyfin.org/files/ffmpeg/debian/7.x/7.0.2-9/armhf/jellyfin-ffmpeg7_7.0.2-9-bookworm_armhf.deb"
    armhf.sha256 = "a12ed104a68cb9f57d40119017920a8d11431e0f8212156eec3f9cd2c5a13bc9"
    arm64.url = "https://repo.jellyfin.org/files/ffmpeg/debian/7.x/7.0.2-9/arm64/jellyfin-ffmpeg7_7.0.2-9-bookworm_arm64.deb"
    arm64.sha256 = "ce38aaa417f8285126e1a8c3e5e4b284a40e9ba903defde1df2eaf9ea53fe704"
    amd64.url = "https://repo.jellyfin.org/files/ffmpeg/debian/7.x/7.0.2-9/amd64/jellyfin-ffmpeg7_7.0.2-9-bookworm_amd64.deb"
    amd64.sha256 = "cd52577405c24f126284f1959288adefe30f8880a9ac6f3125c6eb4b5228ac59"

    format = "whatever"
    extract = false
    rename = "jellyfin-ffmpeg7.deb"


    [resources.sources.plugin_ldap]
    url = "https://repo.jellyfin.org/files/plugin/ldap-authentication/ldap-authentication_19.0.0.0.zip"
    sha256 = "3b8366f670484c9ab1ece826667754b69736d910d9ccde90c105a67ba441ead9"
    in_subdir = false

    [resources.system_user]
    home = "/var/lib/jellyfin"

    [resources.install_dir]
    dir = "/var/lib/jellyfin"

    [resources.permissions]
    # auth_header=false is because Jellyfin expects custom data in the Authorization HTTP header (notably, for Jellyfin Vue)
    main.url = "/"
    main.auth_header = false

    admin.protected = true
    admin.auth_header = false
    admin.show_tile = false

    [resources.ports]
    main.default = 8095
    # If one day we plan to declare them
    #servicediscovery.default = 1900
    #servicediscovery.exposed = "UDP"
    #servicediscovery.fixed = true
    #clientdiscovery.default = 7359
    #clientdiscovery.exposed = "UDP"
    #clientdiscovery.fixed = true

    [resources.apt]
